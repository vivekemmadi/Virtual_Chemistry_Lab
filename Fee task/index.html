<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>School Wallet</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #28a745;
      --secondary-color: #007BFF;
      --background-color: #ffffff;
      --text-primary: #333333;
      --border-color: #e0e0e0;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f6f8;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      width: 100%;
      background: var(--background-color);
      padding: 40px;
      border-radius: 15px;
      box-shadow: var(--shadow);
    }

    .header h2 {
      color: var(--text-primary);
      font-size: 24px;
      font-weight: 700;
      background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
      display: block;
    }

    .filter-input, .filter-select {
      width: 100%;
      padding: 12px;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      font-size: 14px;
    }

    .add-btn, .submit-btn {
      background: var(--primary-color);
      color: white;
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }

    .total {
      text-align: right;
      font-size: 16px;
      font-weight: 600;
      margin-top: 20px;
    }

    .custom-multiselect {
      position: relative;
      width: 100%;
    }

    .select-display {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      background: var(--background-color);
    }

    .options {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      display: none;
      z-index: 1000;
    }

    .option {
      padding: 12px;
      cursor: pointer;
    }

    .option:hover {
      background: #f1f1f1;
    }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <h2>School Wallet</h2>
  </div>
  <div class="form-group">
    <label for="academicYear">Academic Year</label>
    <select id="academicYear" class="filter-select">
      <option value="">Select Academic Year</option>
      <option value="2023-24">2023-24</option>
      <option value="2024-25">2024-25</option>
    </select>
  </div>
  <div class="form-group">
    <label for="feeType">Fee Type</label>
    <select id="feeType" class="filter-select">
      <option value="">Select Fee Type</option>
      <option value="Admission Fee">Admission Fee</option>
      <option value="Annual Fee">Annual Fee</option>
    </select>
  </div>
  <div class="form-group">
    <label for="amount">Amount</label>
    <input type="number" id="amount" class="filter-input" placeholder="Enter amount" min="0">
  </div>
  <button class="add-btn" id="addFeeBtn">Add Fee</button>
  <table id="feeTable">
    <thead>
      <tr>
        <th>Fee Type</th>
        <th>Amount</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div class="total" id="totalAmount">Total Amount: ₹0</div>
  <button class="submit-btn" id="submitFeeDetails">Submit Fee Details</button>

  <div class="form-group">
    <label for="classSelect">Select Class</label>
    <div class="custom-multiselect" id="classSelectDropdown">
      <div class="select-display" id="classSelectDisplay">
        <span>Select Class</span>
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="options" id="classOptions">
        <div class="option">Class 1</div>
        <div class="option">Class 2</div>
        <div class="option">Class 3</div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const feeType = document.getElementById('feeType');
  const amount = document.getElementById('amount');
  const addFeeBtn = document.getElementById('addFeeBtn');
  const feeTable = document.getElementById('feeTable').querySelector('tbody');
  const totalAmount = document.getElementById('totalAmount');
  let total = 0;

  addFeeBtn.addEventListener('click', () => {
    const feeTypeValue = feeType.value;
    const amountValue = parseFloat(amount.value);

    if (!feeTypeValue || !amountValue || amountValue <= 0) {
      alert('Please enter valid fee details.');
      return;
    }

    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${feeTypeValue}</td>
      <td>₹${amountValue.toFixed(2)}</td>
      <td><button class="delete-btn">Delete</button></td>
    `;
    feeTable.appendChild(row);

    total += amountValue;
    totalAmount.textContent = `Total Amount: ₹${total.toFixed(2)}`;

    row.querySelector('.delete-btn').addEventListener('click', () => {
      total -= amountValue;
      totalAmount.textContent = `Total Amount: ₹${total.toFixed(2)}`;
      row.remove();
    });

    feeType.value = '';
    amount.value = '';
  });

  document.getElementById('submitFeeDetails').addEventListener('click', async () => {
    const rows = feeTable.querySelectorAll('tr');
    if (rows.length === 0) {
      alert('No fee details to submit.');
      return;
    }

    const fees = Array.from(rows).map(row => {
      const cells = row.querySelectorAll('td');
      return { feeType: cells[0].textContent, amount: parseFloat(cells[1].textContent.replace('₹', '')) };
    });

    const payload = { academicYear: document.getElementById('academicYear').value, fees, totalAmount: total };
    console.log('Submitting:', payload);

    try {
      const response = await fetch('http://localhost:5000/api/fees', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });

      if (response.ok) {
        alert('Fee details submitted successfully.');
        feeTable.innerHTML = '';
        total = 0;
        totalAmount.textContent = 'Total Amount: ₹0';
      } else {
        throw new Error('Failed to submit fee details.');
      }
    } catch (error) {
      console.error('Error:', error);
      alert('Error submitting fee details.');
    }
  });

  const classSelectDisplay = document.getElementById('classSelectDisplay');
  const classOptions = document.getElementById('classOptions');

  // Toggle dropdown visibility
  classSelectDisplay.addEventListener('click', (e) => {
    e.stopPropagation(); // Prevent event propagation
    const isVisible = classOptions.style.display === 'block';
    document.querySelectorAll('.custom-multiselect .options').forEach(opt => opt.style.display = 'none'); // Hide other dropdowns
    classOptions.style.display = isVisible ? 'none' : 'block'; // Toggle current dropdown
  });

  // Hide dropdown when clicking outside
  document.addEventListener('click', () => {
    classOptions.style.display = 'none';
  });

  // Prevent dropdown from closing when clicking inside
  classOptions.addEventListener('click', (e) => {
    e.stopPropagation();
  });

  // Initialize dropdown to be hidden
  classOptions.style.display = 'none';
});
</script>
</body>
</html>
</html>
